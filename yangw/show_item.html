<html lang="en">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />
		<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons" />
		<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway:400,300,600" />
		<link type="text/css" rel="stylesheet" href="fake_items.css" />	
		<style type="text/css">

		</style>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js" type="text/javascript"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js" type="text/javascript"></script>
		<script src="https://acuth.github.io/awac/awac.js" type="text/javascript"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/marked/0.3.5/marked.min.js" type="text/javascript"></script>
		<!--script src="https://cdnjs.cloudflare.com/ajax/libs/showdown/1.3.0/showdown.min.js" type="text/javascript"></script-->
		<script src="fake_items.js" type="text/javascript"></script>
		<script type="text/javascript">
			var _awac = null;
			var _itemId = null;
			var _fitem = null;
			
			function onAction(action) {
			  if ('back' == action)
			    showPrevPage();
			  else if ('edit' == action) {
			    console.log('edit '+_itemId);
			    _awac.openPage('edit','edit_item.html',{'json':_fitem.json,'item_id':_itemId});
			  }
			  else if ('add' == action) {
			    var labels= ['add comment','add post','add event'];
			    var items = new Array();
			    for (var i=0;i<labels.length;i++) {
			      var item = new Object();
			      item.label = labels[i];
			      items[i] = item;
			    }
			    _awac.list(items,function(n) { if (n != -1) _awac.alert('selected '+n); });
			  }
			  else 
			    _awac.alert('action '+action+' NYI');
			}
			
			function showNextPage(name) {
			  FItem.historyPush(_awac,name);
			  _awac.replacePage('show','show_item.html',{'item_id':name},true);
			}
			
			function showOptions(attr_name) {
			  _awac.alert('show options for attr '+attr_name);
			}
			
			function showUser(wiki_name) {
			  FItem.historyPush(_awac,name);
			  _awac.replacePage('show','show_item.html',{'item_id':wiki_name},true);
			}
			
			function appendEditControls(c) {
			  var html = '<span class="edit-control-span"><i class="material-icons">delete</i></span>' +
			    '<span class="edit-control-span"><i class="material-icons">edit</i></span>';
			  c.html(html);
			}
			
			function appendClearBoth(c) {
			    var d = newDiv();
			    d.css('clear','both');
			    //d.html('-clear-both-');
			    d.appendTo(c);
			}
			
			function newDiv(classes) {
			  var d = $(document.createElement('div'));
			  if (classes) d.addClass(classes);
			  return d;
			}
		
		  function renderItemHeader(fitem,iname,author) {
		      var titleDiv = $('#item-title-div');
			    titleDiv.html('');
			    var t = newDiv('left-content left');
			    newDiv('padded-container item-title').html(fitem.json.name_attr).appendTo(t);
			    t.appendTo(titleDiv);
			    //var c = newDiv('right-controls edit-controls right');
			    //var p = newDiv('padded-container');
			    //appendEditControls(p);
			    //p.appendTo(c);
			    //c.appendTo(titleDiv);
			    appendClearBoth(titleDiv);
			    
			    var typesDiv = $('#item-types-div');
			    typesDiv.html('');
			    t = newDiv('left-content left');
			    newDiv('padded-container').css('display','flex').html('<div class="item-type"><i class="material-icons">'+iname+'</i></div>'+
			      '<div>'+author+'</div>').appendTo(t);
			    t.appendTo(typesDiv);
			    //c = newDiv('right-controls edit-controls right');
			    //p = newDiv('padded-container');
			    //appendEditControls(p);
			    //p.appendTo(c);
			    //c.appendTo(typesDiv);
			    appendClearBoth(typesDiv);
		  }
			
			function showPrevPage() {
			   var name = FItem.historyPop(_awac);
			   if (name) 
			     _awac.replacePage('show','show_item.html',{'item_id':name},false);
			   else
  			   _awac.replacePage('root','index2.html',null,false);
			}
		
			
			$(document).ready(function() {
			  _awac = new Awac('_awac'); 
			  var initp = _awac.getInitParam();
			  if (initp) 
			    _itemId = initp.item_id;
			  else
			    _itemId = 'HomePage';
			    
			  console.log('item-id='+_itemId);
			 
			  var colors = _awac.getColors();
			  if (colors) $('#item-title').css('color',colors.primary_dark);
			    
			  _awac.setOnAction(onAction);
			  _awac.unlockNavDrawer();
			   
			  //_awac.setHomeItem({'label':'Back','icon':'arrow_back','action':'back'});
			  _awac.addActionBarItem({'icon':'add','label':'ADD','action':'add'});
			  _awac.addActionBarItem({'icon':'edit','label':'EDIT','action':'edit'});
			  
			  _awac.setOnBackPressed(function() { onAction('back'); });
			  
			  
			  new AttrType('name');
			  new AttrType('type');
			  var at = AttrType.get('name');
			  console.log('got at='+at);
			  
			  FItem.get(_itemId,function(fitem) { 
			    _fitem = fitem;
			    var iname = fitem.getMDIcon();
			    var a = fitem.getUserHTML(fitem.json.author,true);
			    if (fitem.json.image_url) {
			      $('#item-title-div').html(
			        '<div class="img-container"><img src="'+fitem.json.image_url+'"/>'+
			              '<div class="top"><div class="item-type-inner"><div class="item-type"><i class="material-icons">'+iname+'</i></div></div></div>'+
			              '<div class="img-title"><div class="img-title-inner">'+fitem.json.name_attr+'</div></div>'+
			        '</div>');
			        $('#show-item-type').remove();
			    }
			    else {
			      renderItemHeader(fitem,iname,a);
			    }
			    $('#show-item-markdown').html(fitem.getHTML());
			    _awac.startPage();
			  });   
			});
			</script>
	</head>
	<body>
	   <div id="item-title-div">-item-title-goes-here-</div>
     <div id="item-types-div">-item-types-go-here-</div>
	  
     <div id="show-item-content">
       <!--table id="show-item-meta">
         <tr>
           <td><div id="show-item-type" class="item-type">?</div></td>
           <td id="item-author">-author-details-go-here-</td>
         </tr>
       </table-->
       <div id="show-item-markdown">-item-markup-goes-here-</div>
       <div id="show-itm-footer"><a href="javascript:onAction('edit');">EDIT</a> |  <a href="javascript:onAction('back');">BACK</a></div>
     </div>
	</body>
</html>